{# new_item_table.html #}
<style>
    .usd-group {
        background-color: #e0f7fa; /* Light cyan */
    }
    .eur-group {
        background-color: #fff9c4; /* Light yellow */
    }
    .rub-group {
        background-color: #f0f4c3; /* Light lime */
    }
    table {
        width: 95%;
        border-collapse: collapse;
        margin-left: auto;
        margin-right: auto;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
        font-size: 14px; /* Reduced font size */
    }
    th {
        background-color: #f2f2f2;
    }
    input[type="text"] {
        width: 100%;
        box-sizing: border-box;
        font-size: 14px; /* Reduced font size for input fields as well */
    }
</style>

<table>
    <thead>
        <tr>
            <th>Номер Пункта</th>
            {% for header in header_columns %}
                {% if '__' in header %}
                    {% set parts = header.split('__') %}
                    {% set currency = parts[0] %}
                    {% set field_type = parts[1] %}
                    {% if field_type in ['kurs_prinyato', 'kurs_vydano'] %}
                        {% if currency == 'usd' %}
                            <th class="usd-group">{% if field_type == 'kurs_prinyato' %}USD Принято{% else %}USD Выдано{% endif %}</th>
                        {% elif currency == 'eur' %}
                            <th class="eur-group">{% if field_type == 'kurs_prinyato' %}EUR Принято{% else %}EUR Выдано{% endif %}</th>
                        {% elif currency == 'rub' %}
                            <th class="rub-group">{% if field_type == 'kurs_prinyato' %}RUB Принято{% else %}RUB Выдано{% endif %}</th>
                        {% endif %}
                    {% else %}
                        <th class="{{ currency }}-group">{{ currency|upper }} {{ field_type|replace('_', ' ')|capitalize }}</th>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        <tr>
            <td><a href="/{{ item.nomer_punkta }}">{{ item.nomer_punkta }}</td>
            {% for header in header_columns %}
                {% if '__' in header %}
                    {% set parts = header.split('__') %}
                    {% set currency = parts[0] %}
                    {% set field_type = parts[1] %}
                    {% set value_attr = currency + '_' + field_type %}
                    {% if field_type == 'kurs_prinyato' %}
                        {% if currency == 'usd' %}
                            <td class="usd-group">
                                <input type="text" name="item_{{ item.id }}_usd_kurs_prinyato" value="{{ form_data.get('item_' ~ item.id ~ '_usd_kurs_prinyato', item[value_attr]|default('')) }}">
                            </td>
                        {% elif currency == 'eur' %}
                            <td class="eur-group">
                                <input type="text" name="item_{{ item.id }}_eur_kurs_prinyato" value="{{ form_data.get('item_' ~ item.id ~ '_eur_kurs_prinyato', item[value_attr]|default('')) }}">
                            </td>
                        {% elif currency == 'rub' %}
                            <td class="rub-group">
                                <input type="text" name="item_{{ item.id }}_rub_kurs_prinyato" value="{{ form_data.get('item_' ~ item.id ~ '_rub_kurs_prinyato', item[value_attr]|default('')) }}">
                            </td>
                        {% endif %}
                    {% elif field_type == 'kurs_vydano' %}
                        {% if currency == 'usd' %}
                            <td class="usd-group">
                                <input type="text" name="item_{{ item.id }}_usd_kurs_vydano" value="{{ form_data.get('item_' ~ item.id ~ '_usd_kurs_vydano', item[value_attr]|default('')) }}">
                            </td>
                        {% elif currency == 'eur' %}
                            <td class="eur-group">
                                <input type="text" name="item_{{ item.id }}_eur_kurs_vydano" value="{{ form_data.get('item_' ~ item.id ~ '_eur_kurs_vydano', item[value_attr]|default('')) }}">
                            </td>
                        {% elif currency == 'rub' %}
                            <td class="rub-group">
                                <input type="text" name="item_{{ item.id }}_rub_kurs_vydano" value="{{ form_data.get('item_' ~ item.id ~ '_rub_kurs_vydano', item[value_attr]|default('')) }}">
                            </td>
                        {% endif %}
                    {% else %}
                        {% if currency == 'usd' %}
                            <td class="usd-group" style="font-size: 14px;">{{ item[value_attr]|default('') }}</td>
                        {% elif currency == 'eur' %}
                            <td class="eur-group" style="font-size: 14px;">{{ item[value_attr]|default('') }}</td>
                        {% elif currency == 'rub' %}
                            <td class="rub-group" style="font-size: 14px;">{{ item[value_attr]|default('') }}</td>
                        {% endif %}
                    {% endif %}
                {% endif %}
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>