{# edit_offsets.html #}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Редактирование смещений курсов</title>
    <link rel="stylesheet" href="{{ url_for('static', path='custom___.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='pico.css') }}">
</head>
<style>
    /* Currency group background colors */
    .usd-group { background-color: #b2ebf2; } /* Lighter cyan for USD */
    .eur-group { background-color: #fffde7; } /* Lighter yellow for EUR */
    .rub-group { background-color: #e3f2fd; } /* Lighter blue for RUB */

    /* Specific column styling for purchase/sale rates */
    .usd-group-buy-rate { background-color: #80deea; } /* Darker cyan for USD Buy */
    .usd-group-sell-rate { background-color: #4dd0e1; } /* Even darker cyan for USD Sell */
    .eur-group-buy-rate { background-color: #fff59d; } /* Darker yellow for EUR Buy */
    .eur-group-sell-rate { background-color: #ffee58; } /* Even darker yellow for EUR Sell */
    .rub-group-buy-rate { background-color: #90caf9; } /* Darker blue for RUB Buy */
    .rub-group-sell-rate { background-color: #42a5f5; } /* Even darker blue for RUB Sell */

    /* Specific column styling for overlap rates */
    .usd-group-overlap-rate { color: #00796b; } /* Teal for USD Overlap */
    .eur-group-overlap-rate { color: #f57f17; } /* Orange for EUR Overlap */
    .rub-group-overlap-rate { color: #1565c0; } /* Dark blue for RUB Overlap */

    table {
        width: 95%;
        border-collapse: collapse;
        margin: 10px auto;
        table-layout: fixed;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 3px;
        text-align: center;
        font-size: 10px;
        vertical-align: middle;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    th {
        background-color: #f2f2f2;
        white-space: normal;
        word-break: break-word;
    }
    .negative-cell {
        background-color: #f44336;
        color: white;
        font-weight: bold;
    }
    .bold-text {
        font-weight: bold;
    }
    h2 {
        padding-left: 2.5%;
        margin-bottom: 5px;
        margin-top: 20px;
    }
    td input[type="number"] {
    /* Pico overrides for inputs inside the table */
    padding: 4px 8px;
    font-size: 14px;
    text-align: center;
    border-radius: 4px;
    margin-bottom: 0; /* Important: remove default pico margin */
}
</style>
<body>

    <main class="container">
        <nav class="nav-container">
            <div class="nav-left">
                <a href="/" role="button" class="nav-logout-button" style="margin-right: 1rem;">Домой</a>
                <span class="nav-title">Редактирование смещений курсов</span>
            </div>
        </nav>

        <!-- The form wrapper for the entire table -->
        <form method="POST" action="/offset" class="form-container">
            <table>
                <thead>
                    <tr>
                        <th rowspan="2" class="sales-point-header">Номер точки продаж</th>
                        <th colspan="2" class="usd-group">USD</th>
                        <th colspan="2" class="eur-group">EUR</th>
                        <th colspan="2" class="rub-group">RUB</th>
                    </tr>
                    <tr>
                        <th class="usd-group col-buy">Покупка</th>
                        <th class="usd-group col-sell">Продажа</th>
                        <th class="eur-group col-buy">Покупка</th>
                        <th class="eur-group col-sell">Продажа</th>
                        <th class="rub-group col-buy">Покупка</th>
                        <th class="rub-group col-sell">Продажа</th>
                    </tr>
                </thead>
                <tbody>
                    {# Loop through the context dictionary to populate the table rows #}
                    {% for point_id, values in offsets_data.items() %}
                    <tr>
                        <td class="sales-point-cell">
                            <strong><a href="/{{ point_id }}">{{ point_id }}</a></strong>
                        </td>

                        {# USD Columns #}
                        <td class="usd-group col-buy">
                            <input type="number" name="offsets[{{ point_id }}][usd_buy]" step="0.001" placeholder="0.000" value="{{ values.usd_buy | default('', true) }}">
                        </td>
                        <td class="usd-group col-sell">
                            <input type="number" name="offsets[{{ point_id }}][usd_sell]" step="0.001" placeholder="0.000" value="{{ values.usd_sell | default('', true) }}">
                        </td>

                        {# EUR Columns #}
                        <td class="eur-group col-buy">
                            <input type="number" name="offsets[{{ point_id }}][eur_buy]" step="0.001" placeholder="0.000" value="{{ values.eur_buy | default('', true) }}">
                        </td>
                        <td class="eur-group col-sell">
                            <input type="number" name="offsets[{{ point_id }}][eur_sell]" step="0.001" placeholder="0.000" value="{{ values.eur_sell | default('', true) }}">
                        </td>

                        {# RUB Columns #}
                        <td class="rub-group col-buy">
                             <input type="number" name="offsets[{{ point_id }}][rub_buy]" step="0.001" placeholder="0.000" value="{{ values.rub_buy | default('', true) }}">
                        </td>
                        <td class="rub-group col-sell">
                             <input type="number" name="offsets[{{ point_id }}][rub_sell]" step="0.001" placeholder="0.000" value="{{ values.rub_sell | default('', true) }}">
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="submit-button-container">
                <button type="submit">Сохранить смещения</button>
            </div>
        </form>
    </main>

</body>
</html>
